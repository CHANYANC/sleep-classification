# EEG 기반 수면 단계 분류 모델  
**Zzz Lab | 2025년 1학기 인공지능 프로젝트**

---

## 👥 팀 소개 

| 이름   | 역할                              |
|--------|-----------------------------------|
| 박서현 | 자료조사, 모델링, Flask 제작       |
| 송은주 | 자료조사, Flask 제작               |
| 정민규 | 자료조사, 데이터 전처리, 모델링     |
| 박찬양 | 자료조사, 데이터 전처리, 모델링     |

---

## 문제 정의

본 프로젝트는 **단일 채널 EEG 신호**만을 이용해 수면 단계를 자동 분류하는 딥러닝 모델을 개발하고, 이를 **Flask 기반 웹 애플리케이션**으로 구현한 것입니다. 기존 수면다원검사(PSG)의 고비용·고인력 구조와 **전문가 판독의 편차 문제**를 해결하기 위해, 누구나 사용할 수 있는 자동 수면 분석 시스템을 구축하고자 했습니다.

---

## 💡 주요 내용

- **데이터셋**: PhysioNet의 Sleep-EDF (Fpz-Cz, Pz-Oz 채널 활용)
- **전처리**:
  - FIR 필터를 이용한 밴드패스 필터링
  - 30초 고정 길이 슬라이딩 윈도우 분할 (Stride 15초)
  - FFT 기반 주기성 특징 추출
- **모델 구조**: CNN → BatchNorm → Bi-LSTM → FC (5-class classification)
- **클래스 불균형 처리**: WeightedRandomSampler 적용

---

## 🔎 실험 결과 (F1-score 기준)

| Class | W   | N1  | N2  | N3  | REM |
|-------|-----|-----|-----|-----|-----|
| Score | 0.84 | 0.54 | 0.60 | 0.72 | 0.46 |

> ✅ 깊은 수면(N3), 각성(W) 단계는 안정적으로 분류됨  
> ⚠️ 얕은 수면(N1, N2)과 REM 단계는 혼동이 심해 향후 개선 필요

---

## 🛠️ 시스템 구조

- EEG 데이터 업로드 → 자동 전처리 및 예측 수행
- 예측 결과를 기반으로 **수면 점수**, **수면 단계 비율** 시각화
- Flask 웹 기반 데모로 누구나 사용 가능

---

## 🚀 기대 효과 및 향후 계획

- 수면 분석 전문 인력 없이 **일관된 수면 상태 평가 제공**
- REM/N1/N2 분리를 위한 **attention 기반 모델**, **주파수 도메인 특징** 추가 예정
- 장기적으로는 모바일 앱 또는 **가정용 수면 진단 기기와 연동**하는 시스템 개발

---

## 👥 팀 소개 (Zzz 랩)

| 이름   | 역할                        |
|--------|-----------------------------|
| 박서현 | 신호처리, EDA, 개념 정리         |
| 송은주 | 데이터 수집, 선행연구 조사       |
| 정민규 | 모델 개발, 실험 설계, 분석       |
| 박찬양 | 전처리 구현, 튜닝, 웹 데모 개발  |

---

## 📚 참고 자료

- Sleep-EDF: [https://physionet.org/content/sleep-edfx/1.0.0/](https://physionet.org/content/sleep-edfx/1.0.0/)
- Supratak et al., *TinySleepNet*, EMBC 2020
- 기타 논문 및 자료는 `docs/reference.md`에 정리 예정
